document.addEventListener('DOMContentLoaded',function(){const safeSelect=(selector)=>document.querySelector(selector);const safeSelectAll=(selector)=>document.querySelectorAll(selector);const statsModal=safeSelect('#stats-modal');const statsButton=safeSelect('#menu-stats');const closeModalButton=safeSelect('#close-modal');if(statsButton&&closeModalButton&&statsModal){statsButton.addEventListener('click',()=>{statsModal.classList.remove('hidden');});closeModalButton.addEventListener('click',()=>{statsModal.classList.add('hidden');});window.addEventListener('click',(event)=>{if(event.target===statsModal){statsModal.classList.add('hidden');}});}const menuToggle=safeSelect('.mobile-menu-toggle');const headerActions=safeSelect('.header__actions');const menuOverlay=safeSelect('.menu-overlay');const body=document.body;if(menuToggle&&headerActions&&menuOverlay){const menuItems=headerActions.children;Array.from(menuItems).forEach((item,index)=>{item.style.setProperty('--item-index',index);});menuToggle.addEventListener('click',function(){headerActions.classList.toggle('active');menuOverlay.classList.toggle('active');menuToggle.classList.toggle('active');body.style.overflow=headerActions.classList.contains('active')? 'hidden' : '';});menuOverlay.addEventListener('click',function(){headerActions.classList.remove('active');menuOverlay.classList.remove('active');menuToggle.classList.remove('active');body.style.overflow='';});}const searchInput=safeSelect('#subject-search');const subjectItems=safeSelectAll('.subject-list li');let searchTimeout;if(searchInput&&subjectItems.length>0){function highlightMatch(item,searchTerm){if(searchTerm===''){item.querySelector('.short-form').innerHTML=item.querySelector('.short-form').textContent;item.querySelector('.full-name').innerHTML=item.querySelector('.full-name').textContent;return;}const highlightText=(text,term)=>{const regex=new RegExp(`(${term})`,'gi');return text.replace(regex,'<mark style="background-color: rgba(45,118,204,0.2);color: var(--text-primary);padding: 0 2px;border-radius: 2px;">$1</mark>');};const shortForm=item.querySelector('.short-form');const fullName=item.querySelector('.full-name');shortForm.innerHTML=highlightText(shortForm.textContent,searchTerm);fullName.innerHTML=highlightText(fullName.textContent,searchTerm);}function performSearch(){const searchTerm=searchInput.value.toLowerCase().trim();subjectItems.forEach(item=>{const shortForm=item.querySelector('.short-form').textContent.toLowerCase();const fullName=item.querySelector('.full-name').textContent.toLowerCase();if(shortForm.includes(searchTerm)||fullName.includes(searchTerm)){item.classList.remove('hidden');highlightMatch(item,searchTerm);}else{item.classList.add('hidden');}});const allHidden=Array.from(subjectItems).every(item=>item.classList.contains('hidden'));let noResultsMsg=safeSelect('.no-results-message');if(allHidden&&searchTerm!==''){if(!noResultsMsg){noResultsMsg=document.createElement('div');noResultsMsg.className='no-results-message';noResultsMsg.style.textAlign='center';noResultsMsg.style.padding='2rem';noResultsMsg.style.color='var(--text-muted)';subjectItems[0].parentNode.appendChild(noResultsMsg);}noResultsMsg.textContent=`No subjects found matching "${searchInput.value}"`;noResultsMsg.style.display='block';}else if(noResultsMsg){noResultsMsg.style.display='none';}}searchInput.addEventListener('input',function(){clearTimeout(searchTimeout);searchTimeout=setTimeout(performSearch,300);});searchInput.addEventListener('search',performSearch);if(searchInput.value){performSearch();}}});